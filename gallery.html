<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Anılarımız - Galeri</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="gallery.css">
    <link rel="stylesheet" href="navigation.css">
    <link rel="stylesheet" href="theme-switcher.css">
    <script src="https://cdn.jsdelivr.net/npm/exif-js"></script>
    <style>
        body {
            padding-bottom: 90px !important;
            margin-bottom: 0 !important;
        }
        .gallery-wrapper {
            padding-bottom: 20px;
            margin-bottom: 0;
        }
        .floating-nav {
            position: fixed !important;
            bottom: 0 !important;
            top: auto !important;
        }
        
        /* Mode switcher buttons */
        .mode-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 12px 25px;
            margin: 0 5px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }
        
        .mode-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        
        .mode-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: white;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }
    </style>
</head>
<body>
    <!-- Desktop Navigation -->
    <nav class="desktop-nav">
        <div class="desktop-nav-brand">💕 Bizim Hikayemiz</div>
        <div class="desktop-nav-menu">
            <a href="index.html" class="desktop-nav-item">🏠 Ana Sayfa</a>
            <a href="gallery.html" class="desktop-nav-item active">📸 Galeri</a>
            <a href="bucket-list.html" class="desktop-nav-item">🌈 Hedefler</a>
            <a href="quiz.html" class="desktop-nav-item">🎯 Quiz</a>
            <a href="playlist.html" class="desktop-nav-item">🎵 Müzik</a>
            <a href="gifts.html" class="desktop-nav-item">🎁 Hediyeler</a>
            <a href="reminders.html" class="desktop-nav-item">📅 Hatırlatıcılar</a>
            <a href="admin.html" class="desktop-nav-item">⚙️ Ayarlar</a>
            <button onclick="logout()" class="desktop-nav-item">🚪 Çıkış</button>
        </div>
    </nav>

    <!-- Mobile Navigation -->
    <div class="more-menu-overlay" id="moreMenuOverlay"></div>
    <div class="more-menu" id="moreMenu">
        <a href="quiz.html" class="more-menu-item">
            <span class="menu-icon">🎯</span>
            <span>Quiz</span>
        </a>
        <a href="playlist.html" class="more-menu-item">
            <span class="menu-icon">🎵</span>
            <span>Müzik</span>
        </a>
        <a href="gifts.html" class="more-menu-item">
            <span class="menu-icon">🎁</span>
            <span>Hediyeler</span>
        </a>
        <a href="admin.html" class="more-menu-item">
            <span class="menu-icon">⚙️</span>
            <span>Ayarlar</span>
        </a>
        <button onclick="logout()" class="more-menu-item">
            <span class="menu-icon">🚪</span>
            <span>Çıkış</span>
        </button>
    </div>

    <nav class="floating-nav">
        <a href="index.html" class="nav-item">
            <span class="nav-icon">🏠</span>
            <span class="nav-text">Ana Sayfa</span>
        </a>
        <a href="gallery.html" class="nav-item active">
            <span class="nav-icon">📸</span>
            <span class="nav-text">Galeri</span>
        </a>
        <a href="bucket-list.html" class="nav-item">
            <span class="nav-icon">🌈</span>
            <span class="nav-text">Hedefler</span>
        </a>
        <a href="reminders.html" class="nav-item">
            <span class="nav-icon">📅</span>
            <span class="nav-text">Hatırlatıcılar</span>
        </a>
        <button class="nav-item" id="moreBtn">
            <span class="nav-icon">⋯</span>
            <span class="nav-text">Diğer</span>
        </button>
    </nav>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const moreBtn = document.getElementById('moreBtn');
            const moreMenu = document.getElementById('moreMenu');
            const moreMenuOverlay = document.getElementById('moreMenuOverlay');
            
            if (moreBtn && moreMenu && moreMenuOverlay) {
                moreBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    moreMenu.classList.toggle('active');
                    moreMenuOverlay.classList.toggle('active');
                });
                
                moreMenuOverlay.addEventListener('click', () => {
                    moreMenu.classList.remove('active');
                    moreMenuOverlay.classList.remove('active');
                });
            }
        });
    </script>

    <div class="hearts-container"></div>

    <script src="auth.js"></script>
    <script>if (!checkAuth()) window.location.href = 'login.html';</script>

    <div class="gallery-wrapper">
        <!-- Hero Section -->
        <div class="gallery-hero">
            <div class="hero-bg"></div>
            <div class="hero-content">
                <h1 class="hero-title">
                    <span class="title-line">Bizim</span>
                    <span class="title-line highlight">Anılarımız</span>
                </h1>
                <p class="hero-subtitle">Her fotoğraf bir hikaye, her an değerli </p>
                <div class="hero-stats">
                    <div class="stat-item">
                        <span class="stat-number" id="totalPhotos">0</span>
                        <span class="stat-label">Fotoğraf</span>
                    </div>
                    <div class="stat-divider"></div>
                    <div class="stat-item">
                        <span class="stat-number" id="totalMemories">0</span>
                        <span class="stat-label">Anı</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Filter Bar -->
        <div class="filter-bar">
            <div class="filter-container">
                <div class="filter-section">
                    <span class="filter-label"></span>
                    <div class="filter-buttons" id="categoryFilters">
                        <button class="filter-chip active" data-filter="all">Tümü</button>
                        <button class="filter-chip" data-filter="tatil"> Tatil</button>
                        <button class="filter-chip" data-filter="selfie"> Selfie</button>
                        <button class="filter-chip" data-filter="özel"> Özel</button>
                        <button class="filter-chip" data-filter="doğa"> Doğa</button>
                    </div>
                </div>
                <div class="filter-section">
                    <span class="filter-label"></span>
                    <div class="filter-buttons" id="dateFilters">
                        <button class="filter-chip date-chip active" data-date="all">Tümü</button>
                        <button class="filter-chip date-chip" data-date="this-month">Bu Ay</button>
                        <button class="filter-chip date-chip" data-date="last-month">Geçen Ay</button>
                        <button class="filter-chip date-chip" data-date="this-year">Bu Yıl</button>
                        <button class="filter-chip date-chip" data-date="older">Daha Eski</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Upload Section -->
        <div class="upload-section">
            <div class="upload-container">
                <h3 class="upload-title">📷 Yeni Anı Ekle</h3>
                
                <!-- Fotoğraf/Video toggle -->
                <div style="text-align: center; margin-bottom: 20px;">
                    <button id="photoModeBtn" onclick="switchUploadMode('photo')" class="mode-btn active">
                        📸 Fotoğraf
                    </button>
                    <button id="videoModeBtn" onclick="switchUploadMode('video')" class="mode-btn">
                        🎬 Video
                    </button>
                </div>
                
                <input type="file" id="uploadInput" accept="image/*" multiple style="display: none;">
                <input type="file" id="videoUploadInput" accept="video/*" style="display: none;">
                
                <label for="uploadInput" class="upload-area" id="uploadArea">
                    <div class="upload-emoji-btn">
                        📸
                    </div>
                    <div class="upload-icon"></div>
                    <p class="upload-text">Fotoğraf yüklemek için tıklayın</p>
                    <p class="upload-hint">veya sürükle bırak</p>
                </label>
                
                <label for="videoUploadInput" class="upload-area" id="videoUploadArea" style="display: none;">
                    <div class="upload-emoji-btn">
                        🎬
                    </div>
                    <div class="upload-icon"></div>
                    <p class="upload-text">Video yüklemek için tıklayın</p>
                    <p class="upload-hint">Max 50MB, 5 dakika</p>
                </label>
            </div>
        </div>

        <!-- Upload Modal -->
        <div id="uploadModal" class="upload-modal">
            <div class="modal-content">
                <button class="modal-close" onclick="closeUploadModal()"></button>
                <h3>Fotoğraf Detayları</h3>
                <div class="modal-preview">
                    <img id="previewImage" src="" alt="Önizleme">
                </div>
                <div class="modal-form">
                    <div class="form-field">
                        <label> Açıklama</label>
                        <input type="text" id="uploadCaption" placeholder="Bu anı hakkında bir şeyler yazın...">
                    </div>
                    <div class="form-field">
                        <label> Kategori</label>
                        <select id="uploadCategory">
                            <option value="diğer"> Diğer</option>
                            <option value="tatil"> Tatil</option>
                            <option value="selfie"> Selfie</option>
                            <option value="özel"> Özel</option>
                            <option value="doğa"> Doğa</option>
                        </select>
                    </div>
                    <div class="form-field">
                        <label> Tarih (boş bırakılırsa bugünün tarihi kullanılır)</label>
                        <input type="date" id="uploadDate" placeholder="Opsiyonel">
                    </div>
                    <div id="exifInfo" class="exif-info" style="display: none;">
                        <h4> Fotoğraf Bilgileri</h4>
                        <div id="exifDetails"></div>
                    </div>
                    <button class="upload-btn" onclick="confirmUpload()">
                        <span></span> Anıyı Kaydet
                    </button>
                </div>
            </div>
        </div>

        <!-- Photos Grid -->
        <div class="photos-container">
            <div id="photoGrid" class="masonry-grid">
                <!-- Photos will be loaded here -->
            </div>

            <!-- Empty State -->
            <div id="emptyState" class="empty-gallery" style="display: none;">
                <div class="empty-animation">
                    <div class="empty-circle"></div>
                    <div class="empty-icon"></div>
                </div>
                <h2 class="empty-title">Henüz Fotoğraf Yok</h2>
                <p class="empty-text">Güzel anılarınızı paylaşmaya başlayın!</p>
                <button onclick="window.location.href='admin.html'" class="empty-button">
                    <span></span> İlk Anıyı Ekle
                </button>
            </div>
        </div>

        <!-- Lightbox -->
        <div id="lightbox" class="lightbox-overlay">
            <button id="lightboxClose" class="lightbox-close"></button>
            <button id="lightboxPrev" class="lightbox-arrow left"></button>
            <button id="lightboxNext" class="lightbox-arrow right"></button>
            
            <div class="lightbox-container">
                <div class="lightbox-image-wrapper">
                    <img id="lightboxImage" class="lightbox-image" src="" alt="">
                </div>
                <div class="lightbox-details">
                    <h3 id="lightboxCaption" class="lightbox-title">-</h3>
                    <p id="lightboxMeta" class="lightbox-info">-</p>
                </div>
            </div>
        </div>
    </div>

    <script src="theme-switcher.js"></script>
    <script src="video-manager.js"></script>
    <script>
        // Video upload mode switcher
        function switchUploadMode(mode) {
            const photoBtn = document.getElementById('photoModeBtn');
            const videoBtn = document.getElementById('videoModeBtn');
            const photoArea = document.getElementById('uploadArea');
            const videoArea = document.getElementById('videoUploadArea');
            
            if (mode === 'photo') {
                photoBtn.classList.add('active');
                videoBtn.classList.remove('active');
                photoArea.style.display = 'flex';
                videoArea.style.display = 'none';
            } else {
                videoBtn.classList.add('active');
                photoBtn.classList.remove('active');
                videoArea.style.display = 'flex';
                photoArea.style.display = 'none';
            }
        }
        
        // Video upload handler
        document.getElementById('videoUploadInput')?.addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if (!file) return;
            
            try {
                const caption = prompt('Video için bir açıklama girin:', 'Güzel bir anımız');
                if (caption === null) return;
                
                const category = prompt('Kategori (tatil/özel/diğer):', 'diğer');
                
                await videoManager.addVideo(file, caption, category);
                alert('✅ Video başarıyla yüklendi!');
                
                // Video listesini göster
                videoManager.renderVideos('videoGallery');
            } catch (error) {
                alert('❌ ' + error);
            }
        });
    </script>
    <script type="module" src="gallery.js"></script>
    <script type="module" src="script.js"></script>
    <script type="module" src="notification-listener.js"></script>
    
    <!-- Bottom Navigation removed (unified navigation is added earlier in the document) -->
</body>
</html>