<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ”” Bildirim Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        button {
            background: rgba(255,255,255,0.3);
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            color: white;
            font-size: 16px;
            cursor: pointer;
            margin: 10px 5px;
            width: 100%;
        }
        button:hover {
            background: rgba(255,255,255,0.4);
        }
        .success {
            background: rgba(74, 222, 128, 0.5);
        }
        .error {
            background: rgba(255, 0, 0, 0.5);
        }
        #status {
            margin-top: 20px;
            padding: 15px;
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
            font-family: monospace;
            white-space: pre-wrap;
            font-size: 14px;
        }
        .info-box {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid white;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”” Bildirim Test Merkezi</h1>
        <p>TÃ¼m bildirim tÃ¼rlerini test edin</p>
        
        <div class="info-box">
            <strong>ğŸ“Œ Ã–nemli:</strong><br>
            â€¢ Mobilde Ã§alÄ±ÅŸmasÄ± iÃ§in PWA olarak yÃ¼klenmiÅŸ olmalÄ±<br>
            â€¢ TarayÄ±cÄ± bildirim iznine izin vermelisiniz<br>
            â€¢ BazÄ± telefonlarda "Sessiz mod" kapalÄ± olmalÄ±
        </div>
        
        <h3>1ï¸âƒ£ Ä°zin KontrolÃ¼</h3>
        <button onclick="checkPermission()">ğŸ“‹ Bildirim Ä°zni Kontrol Et</button>
        <button onclick="requestPermission()">ğŸ”“ Bildirim Ä°zni Ä°ste</button>
        
        <h3>2ï¸âƒ£ Test Bildirimleri</h3>
        <button onclick="testBasicNotification()">ğŸ“¢ Basit Bildirim</button>
        <button onclick="testPhotoNotification()">ğŸ“¸ Yeni FotoÄŸraf Bildirimi</button>
        <button onclick="testReminderNotification()">ğŸ“… HatÄ±rlatÄ±cÄ± Bildirimi</button>
        <button onclick="testBucketNotification()">ğŸŒˆ Bucket List Bildirimi</button>
        <button onclick="testAnniversary()">ğŸ‰ YÄ±ldÃ¶nÃ¼mÃ¼ Bildirimi</button>
        
        <h3>3ï¸âƒ£ Sistem Testi</h3>
        <button onclick="testServiceWorker()">âš™ï¸ Service Worker Kontrol</button>
        <button onclick="testPushAPI()">ğŸ”” Push API DesteÄŸi</button>
        
        <div id="status">HazÄ±r... Test iÃ§in butona tÄ±klayÄ±n! ğŸš€</div>
    </div>

    <script>
        const status = document.getElementById('status');

        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString('tr-TR');
            const icon = type === 'success' ? 'âœ…' : type === 'error' ? 'âŒ' : 'ğŸ“‹';
            status.textContent += `\n[${timestamp}] ${icon} ${message}`;
            status.scrollTop = status.scrollHeight;
            console.log(message);
        }

        async function checkPermission() {
            status.textContent = '';
            
            if (!('Notification' in window)) {
                log('Bu tarayÄ±cÄ± bildirimleri desteklemiyor! ğŸ˜¢', 'error');
                return;
            }
            
            const permission = Notification.permission;
            log(`Bildirim Ä°zni: ${permission}`);
            
            if (permission === 'granted') {
                log('Bildirimler aktif! ğŸ‰', 'success');
            } else if (permission === 'denied') {
                log('Bildirim izni reddedilmiÅŸ! TarayÄ±cÄ± ayarlarÄ±ndan aÃ§Ä±n.', 'error');
            } else {
                log('Bildirim izni henÃ¼z sorulmamÄ±ÅŸ. "Ä°zin Ä°ste" butonuna tÄ±klayÄ±n.', 'info');
            }
        }

        async function requestPermission() {
            status.textContent = '';
            
            if (!('Notification' in window)) {
                log('Bu tarayÄ±cÄ± bildirimleri desteklemiyor!', 'error');
                return;
            }
            
            log('Bildirim izni isteniyor...');
            
            try {
                const permission = await Notification.requestPermission();
                log(`KullanÄ±cÄ± cevabÄ±: ${permission}`);
                
                if (permission === 'granted') {
                    log('Ä°zin verildi! ğŸ‰', 'success');
                    testBasicNotification();
                } else {
                    log('Ä°zin reddedildi! âŒ', 'error');
                }
            } catch (error) {
                log(`Hata: ${error.message}`, 'error');
            }
        }

        async function testBasicNotification() {
            status.textContent = '';
            
            if (Notification.permission !== 'granted') {
                log('Ã–nce bildirim izni verin!', 'error');
                return;
            }
            
            log('Basit bildirim gÃ¶nderiliyor...');
            
            try {
                const notification = new Notification('ğŸ‰ Test Bildirimi', {
                    body: 'Bu bir test bildirimidir. GÃ¶rÃ¼yorsanÄ±z her ÅŸey Ã§alÄ±ÅŸÄ±yor! ğŸ’•',
                    icon: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y="75" font-size="75">ğŸ’•</text></svg>',
                    tag: 'test-notification',
                    vibrate: [200, 100, 200],
                    requireInteraction: false
                });
                
                notification.onclick = () => {
                    log('Bildirime tÄ±klandÄ±!', 'success');
                    notification.close();
                    window.focus();
                };
                
                setTimeout(() => notification.close(), 5000);
                
                log('Bildirim gÃ¶nderildi! ğŸ“¤', 'success');
            } catch (error) {
                log(`Bildirim hatasÄ±: ${error.message}`, 'error');
            }
        }

        async function testPhotoNotification() {
            status.textContent = '';
            log('FotoÄŸraf bildirimi gÃ¶nderiliyor...');
            
            if (Notification.permission !== 'granted') {
                log('Ã–nce bildirim izni verin!', 'error');
                return;
            }
            
            const notification = new Notification('ğŸ“¸ Yeni FotoÄŸraf!', {
                body: 'Sevgilin yeni bir anÄ± ekledi. GÃ¶rmeye gitmez misin? ğŸ’•',
                icon: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y="75" font-size="75">ğŸ“¸</text></svg>',
                vibrate: [200, 100, 200, 100, 200]
            });
            
            setTimeout(() => notification.close(), 5000);
            log('FotoÄŸraf bildirimi gÃ¶nderildi!', 'success');
        }

        async function testReminderNotification() {
            status.textContent = '';
            log('HatÄ±rlatÄ±cÄ± bildirimi gÃ¶nderiliyor...');
            
            if (Notification.permission !== 'granted') {
                log('Ã–nce bildirim izni verin!', 'error');
                return;
            }
            
            const notification = new Notification('ğŸ“… BugÃ¼n Ã–zel Bir GÃ¼n!', {
                body: 'YÄ±ldÃ¶nÃ¼mÃ¼nÃ¼z! Mutlu yÄ±llar! ğŸ‰ğŸ’•',
                icon: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y="75" font-size="75">ğŸ‰</text></svg>',
                vibrate: [300, 100, 300, 100, 300],
                requireInteraction: true
            });
            
            setTimeout(() => notification.close(), 10000);
            log('HatÄ±rlatÄ±cÄ± bildirimi gÃ¶nderildi!', 'success');
        }

        async function testBucketNotification() {
            status.textContent = '';
            log('Bucket list bildirimi gÃ¶nderiliyor...');
            
            if (Notification.permission !== 'granted') {
                log('Ã–nce bildirim izni verin!', 'error');
                return;
            }
            
            const notification = new Notification('ğŸŒˆ Yeni Hedef Eklendi!', {
                body: 'Sevgilin yeni bir hedef ekledi: "Birlikte gÃ¼n doÄŸumu izlemek" ğŸ¯',
                icon: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y="75" font-size="75">ğŸŒˆ</text></svg>',
                vibrate: [200, 100, 200]
            });
            
            setTimeout(() => notification.close(), 5000);
            log('Bucket list bildirimi gÃ¶nderildi!', 'success');
        }

        async function testAnniversary() {
            status.textContent = '';
            log('YÄ±ldÃ¶nÃ¼mÃ¼ bildirimi gÃ¶nderiliyor...');
            
            if (Notification.permission !== 'granted') {
                log('Ã–nce bildirim izni verin!', 'error');
                return;
            }
            
            const notification = new Notification('ğŸŠ 1. YÄ±l DÃ¶nÃ¼mÃ¼nÃ¼z! ğŸŠ', {
                body: 'Ä°lk tanÄ±ÅŸma tarihinin 1. yÄ±lÄ±! Mutlu yÄ±ldÃ¶nÃ¼mÃ¼! ğŸ’•âœ¨',
                icon: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y="75" font-size="75">ğŸŠ</text></svg>',
                vibrate: [300, 100, 300, 100, 300, 100, 300],
                requireInteraction: true
            });
            
            setTimeout(() => notification.close(), 10000);
            log('YÄ±ldÃ¶nÃ¼mÃ¼ bildirimi gÃ¶nderildi!', 'success');
        }

        async function testServiceWorker() {
            status.textContent = '';
            log('Service Worker kontrol ediliyor...');
            
            if (!('serviceWorker' in navigator)) {
                log('Service Worker desteklenmiyor!', 'error');
                return;
            }
            
            try {
                const registration = await navigator.serviceWorker.getRegistration();
                
                if (registration) {
                    log(`Service Worker kayÄ±tlÄ±! âœ…`, 'success');
                    log(`Scope: ${registration.scope}`);
                    log(`Active: ${registration.active ? 'Evet' : 'HayÄ±r'}`);
                } else {
                    log('Service Worker kayÄ±tlÄ± deÄŸil!', 'error');
                    log('PWA olarak yÃ¼klemeyi deneyin.');
                }
            } catch (error) {
                log(`Hata: ${error.message}`, 'error');
            }
        }

        async function testPushAPI() {
            status.textContent = '';
            log('Push API kontrol ediliyor...');
            
            if (!('PushManager' in window)) {
                log('Push API desteklenmiyor!', 'error');
                log('Bu tarayÄ±cÄ±da push notification Ã§alÄ±ÅŸmaz.');
                return;
            }
            
            log('Push API destekleniyor! âœ…', 'success');
            
            if ('serviceWorker' in navigator) {
                try {
                    const registration = await navigator.serviceWorker.ready;
                    const subscription = await registration.pushManager.getSubscription();
                    
                    if (subscription) {
                        log('Push subscription var! âœ…', 'success');
                        log(`Endpoint: ${subscription.endpoint.substring(0, 50)}...`);
                    } else {
                        log('Push subscription yok.', 'info');
                        log('Push notification iÃ§in VAPID key gerekli.');
                    }
                } catch (error) {
                    log(`Push API hatasÄ±: ${error.message}`, 'error');
                }
            }
        }

        // Sayfa yÃ¼klendiÄŸinde otomatik kontrol
        window.onload = () => {
            log('Test sayfasÄ± yÃ¼klendi! ğŸš€');
            log('Bildirim testi iÃ§in butona tÄ±klayÄ±n.');
            checkPermission();
        };
    </script>
</body>
</html>
